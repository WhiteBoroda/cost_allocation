<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Partner form view extension for support level -->
    <record id="view_partner_form_support_level" model="ir.ui.view">
        <field name="name">res.partner.form.support.level</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='accounting']" position="before">
                <page string="Service Support" invisible="not is_company">
                    <group>
                        <group string="Support Level &amp; SLA">
                            <field name="support_level" widget="badge"
                                   decoration-danger="support_level == 'enterprise'"
                                   decoration-warning="support_level == 'premium'"
                                   decoration-info="support_level == 'standard'"
                                   decoration-muted="support_level == 'basic'"/>
                            <field name="workload_multiplier" readonly="1"/>
                        </group>
                        <group string="SLA Times">
                            <field name="sla_response_time" widget="float_time" readonly="1"/>
                            <field name="sla_resolution_time" widget="float_time" readonly="1"/>
                        </group>
                    </group>

                    <div class="alert alert-info mt-3" role="status">
                        <h5><i class="fa fa-info-circle" title="Information"/> Support Level Impact</h5>
                        <p><strong>Basic:</strong> Longer SLA times, reduced workload priority (0.8x)</p>
                        <p><strong>Standard:</strong> Standard SLA times, normal workload (1.0x)</p>
                        <p><strong>Premium:</strong> Faster SLA times, increased attention (1.3x)</p>
                        <p><strong>Enterprise:</strong> Fastest SLA times, maximum priority (1.6x)</p>
                    </div>

                    <group string="Cost Drivers">
                        <group>
                            <field name="workstation_count"/>
                            <field name="user_count"/>
                            <field name="server_count"/>
                        </group>
                        <group>
                            <field name="phone_count"/>
                            <field name="printer_count"/>
                        </group>
                    </group>

                    <group string="Cost Analysis">
                        <group>
                            <field name="last_monthly_cost" widget="monetary"/>
                            <field name="last_cost_date"/>
                        </group>
                        <group>
                            <field name="cost_trend" widget="badge"
                                   decoration-danger="cost_trend == 'up'"
                                   decoration-success="cost_trend == 'down'"
                                   decoration-info="cost_trend == 'stable'"
                                   decoration-muted="cost_trend == 'new'"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Services">
                            <field name="client_service_ids">
                                <tree>
                                    <field name="name"/>
                                    <field name="service_type_id"/>
                                    <field name="effective_response_time" widget="float_time"/>
                                    <field name="effective_resolution_time" widget="float_time"/>
                                    <field name="effective_workload_factor"/>
                                    <field name="brand"/>
                                    <field name="model"/>
                                    <field name="quantity"/>
                                    <field name="status" widget="badge"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Subscriptions">
                            <field name="subscription_ids">
                                <tree>
                                    <field name="name"/>
                                    <field name="state" widget="badge"/>
                                    <field name="start_date"/>
                                    <field name="total_amount" widget="monetary"/>
                                </tree>
                            </field>
                        </page>
                        <page string="Cost Allocations">
                            <field name="cost_allocation_ids">
                                <tree>
                                    <field name="period_date"/>
                                    <field name="direct_cost" widget="monetary"/>
                                    <field name="indirect_cost" widget="monetary"/>
                                    <field name="admin_cost" widget="monetary"/>
                                    <field name="total_cost" widget="monetary"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Partner tree view - add support level column -->
    <record id="view_partner_tree_support_level" model="ir.ui.view">
        <field name="name">res.partner.tree.support.level</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_tree"/>
        <field name="arch" type="xml">
            <field name="phone" position="after">
                <field name="support_level" optional="hide" widget="badge"/>
                <field name="service_count" optional="hide"/>
            </field>
        </field>
    </record>

    <!-- Partner search view - add support level filters -->
    <record id="view_res_partner_filter_support_level" model="ir.ui.view">
        <field name="name">res.partner.select.support.level</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_res_partner_filter"/>
        <field name="arch" type="xml">
            <filter name="customer" position="after">
                <separator/>
                <filter string="Basic Support" name="basic_support" domain="[('support_level', '=', 'basic')]"/>
                <filter string="Standard Support" name="standard_support" domain="[('support_level', '=', 'standard')]"/>
                <filter string="Premium Support" name="premium_support" domain="[('support_level', '=', 'premium')]"/>
                <filter string="Enterprise Support" name="enterprise_support" domain="[('support_level', '=', 'enterprise')]"/>
            </filter>
            <xpath expr="//group[@expand='0']" position="inside">
                <filter string="Support Level" name="group_support_level" context="{'group_by': 'support_level'}"/>
            </xpath>
        </field>
    </record>

</odoo>