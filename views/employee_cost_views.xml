<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Employee Cost Tree View -->
    <record id="view_employee_cost_tree" model="ir.ui.view">
        <field name="name">cost.employee.tree</field>
        <field name="model">cost.employee</field>
        <field name="arch" type="xml">
            <tree string="Employee Costs" decoration-warning="use_manual==True">
                <field name="employee_id"/>
                <field name="monthly_salary" widget="monetary"
                       groups="cost_allocation.group_cost_allocation_financial"/>
                <field name="monthly_benefits" widget="monetary"
                       groups="cost_allocation.group_cost_allocation_financial"/>
                <field name="monthly_hours"/>
                <field name="hourly_cost" widget="monetary"
                       groups="cost_allocation.group_cost_allocation_financial"/>
                <field name="monthly_total_cost" widget="monetary"
                       groups="cost_allocation.group_cost_allocation_financial"/>
                <field name="use_manual" widget="boolean_toggle"/>
                <field name="last_payroll_period"
                       groups="cost_allocation.group_cost_allocation_financial"/>
                <field name="currency_id" column_invisible="1"/>
            </tree>
        </field>
    </record>

    <!-- Employee Cost Form View -->
    <record id="view_employee_cost_form" model="ir.ui.view">
        <field name="name">cost.employee.form</field>
        <field name="model">cost.employee</field>
        <field name="arch" type="xml">
            <form string="Employee Cost">
                <header>
                    <button name="action_update_from_contract" type="object"
                            string="Update from Contract" class="btn-primary"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1><field name="employee_id" placeholder="Select Employee"/></h1>
                    </div>

                    <group>
                        <group>
                            <field name="use_manual"/>
                            <field name="active"/>
                        </group>
                        <group>
                            <field name="last_payroll_period" readonly="1"/>
                            <field name="hourly_cost" widget="monetary" readonly="1"/>
                            <field name="monthly_total_cost" widget="monetary" readonly="1"/>
                            <field name="currency_id" column_invisible="1"/>
                        </group>
                    </group>
                    <group string="Working Hours Configuration" name="working_hours">
                        <group>
                            <field name="use_dynamic_hours" widget="boolean_toggle"/>
                            <field name="calculation_period"
                                   invisible="not use_dynamic_hours"/>
                            <field name="resource_calendar_id"
                                   invisible="not use_dynamic_hours"
                                   placeholder="Use company default calendar"/>
                        </group>
                        <group>
                            <field name="manual_monthly_hours"
                                   invisible="use_dynamic_hours"
                                   required="not use_dynamic_hours"/>
                            <field name="monthly_hours" readonly="1"/>
                            <button name="action_recalculate_hours"
                                    type="object"
                                    string="Recalculate Hours"
                                    class="btn-secondary"
                                    invisible="not use_dynamic_hours"
                                    icon="fa-refresh"/>
                        </group>
                    </group>

                    <div class="alert alert-info mt-3" role="status" invisible="not use_dynamic_hours">
                        <h5><i class="fa fa-info-circle" title="Information"/> Dynamic Working Hours</h5>
                        <p><strong>Enabled:</strong> Working hours are calculated automatically based on:</p>
                        <ul>
                            <li>Company or employee-specific working calendar</li>
                            <li>Weekends and public holidays</li>
                            <li>Actual working days in each month</li>
                        </ul>
                        <p>Hours are updated automatically at the beginning of each month.</p>
                    </div>

                    <div class="alert alert-warning mt-3" role="status" invisible="use_dynamic_hours">
                        <h5><i class="fa fa-warning" title="Warning"/> Manual Working Hours</h5>
                        <p><strong>Fixed Value:</strong> Using manual working hours override.</p>
                        <p>Consider enabling dynamic calculation for more accurate cost allocation.</p>
                    </div>

                    <notebook>
                        <page string="Cost Data">
                            <div class="alert alert-info" role="status">
                                <h4><i class="fa fa-info-circle" title="Information"/> How it works</h4>
                                <p><strong>Contract Wage:</strong> Enter the total monthly cost in HR contract (salary + all taxes + contributions)</p>
                                <p><strong>Benefits:</strong> Any additional costs like health insurance, bonuses, etc.</p>
                                <p><strong>Manual Override:</strong> Use when you need custom values different from contract</p>
                            </div>

                            <group string="Auto-calculated from Contract"
                                   invisible="use_manual"
                                   groups="cost_allocation.group_cost_allocation_financial">
                                <group>
                                    <field name="monthly_salary" widget="monetary" readonly="1"
                                           help="Total monthly cost including all taxes from HR contract"/>
                                    <field name="monthly_benefits" widget="monetary" readonly="1"
                                           help="Additional benefits and costs"/>
                                </group>
                            </group>

                            <group string="Manual Override Values"
                                   invisible="not use_manual"
                                   groups="cost_allocation.group_cost_allocation_financial">
                                <group>
                                    <field name="manual_salary" widget="monetary"
                                           help="Total monthly cost including all taxes"/>
                                    <field name="manual_benefits" widget="monetary"
                                           help="Additional benefits and costs"/>
                                </group>
                            </group>

                            <div class="alert alert-warning" role="status" invisible="not use_manual">
                                <i class="fa fa-exclamation-triangle" title="Warning"/> Manual override is active.
                                Contract updates will be ignored until you disable manual mode.
                            </div>
                        </page>

                        <page string="Statistics" groups="cost_allocation.group_cost_allocation_financial">
                            <group>
                                <group string="Monthly">
                                    <field name="monthly_salary" widget="monetary" readonly="1"/>
                                    <field name="monthly_benefits" widget="monetary" readonly="1"/>
                                    <field name="monthly_total_cost" widget="monetary" readonly="1"
                                           decoration-bf="1"/>
                                </group>
                                <group string="Hourly">
                                    <field name="monthly_hours" readonly="1"/>
                                    <field name="hourly_cost" widget="monetary" readonly="1"
                                           decoration-bf="1"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Employee Cost Search View -->
    <record id="view_employee_cost_search" model="ir.ui.view">
        <field name="name">cost.employee.search</field>
        <field name="model">cost.employee</field>
        <field name="arch" type="xml">
            <search string="Search Employee Costs">
                <field name="employee_id"/>

                <separator/>
                <filter string="Manual Override" name="manual"
                        domain="[('use_manual', '=', True)]"/>
                <filter string="Auto-calculated" name="auto"
                        domain="[('use_manual', '=', False)]"/>
                <filter string="Active" name="active"
                        domain="[('active', '=', True)]"/>

                <group expand="1" string="Group By">
                    <filter string="Data Source" name="group_manual"
                            context="{'group_by': 'use_manual'}"/>
                </group>
            </search>
        </field>
    </record>
</odoo>